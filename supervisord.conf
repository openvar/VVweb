[supervisord]
; Main supervisord configuration
logfile=/local/VVweb/logs/supervisord.log           ; supervisord main log file
logfile_maxbytes=50MB                               ; max size before rotation
logfile_backups=10                                  ; number of rotated logs to keep
loglevel=info                                       ; logging level (debug, info, warn, error)
pidfile=/local/VVweb/supervisord.pid                ; supervisord pid file
nodaemon=false                                      ; run as daemon (false = run in background)
minfds=1024                                         ; minimum number of file descriptors
minprocs=200                                        ; minimum number of processes

[program:celery_worker]
; Celery worker process configuration
command=/local/miniconda3/envs/vvweb_v2/bin/celery -A VVweb worker -l error --logfile=/local/VVweb/logs/celery_worker.log --pidfile=/local/VVweb/celery_worker.pid
autostart=true                                     ; start automatically when supervisord starts
autorestart=true                                   ; restart if process exits unexpectedly
stopwaitsecs=10                                    ; seconds to wait for graceful shutdown
stdout_logfile=/local/VVweb/logs/celery_worker_out.log
stderr_logfile=/local/VVweb/logs/celery_worker_err.log
redirect_stderr=true                               ; merge stderr into stdout log

[program:celery_beat]
; Celery beat scheduler process configuration
command=/local/miniconda3/envs/vvweb_v2/bin/celery -A VVweb beat -l error --scheduler django_celery_beat.schedulers.DatabaseScheduler --logfile=/local/VVweb/logs/celery_beat.log --pidfile=/local/VVweb/celery_beat.pid
autostart=true                                     ; start automatically
autorestart=true                                   ; restart on unexpected exit
stopwaitsecs=10                                    ; graceful shutdown time
stdout_logfile=/local/VVweb/logs/celery_beat_out.log
stderr_logfile=/local/VVweb/logs/celery_beat_err.log
redirect_stderr=true                               ; merge stderr into stdout log
